<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Buscar Reclamações</title>
</head>
<body>
  <h1>Buscar Reclamações</h1>
  <input type="text" id="searchInput" placeholder="Digite parte do título...">
  <button id="searchButton">Buscar</button>

  <!-- Área onde serão exibidos os resultados -->
  <div id="results"></div>

  <script>
    document.getElementById('searchButton').addEventListener('click', function() {
      const nome = document.getElementById('searchInput').value.trim();
      if (!nome) {
        alert("Por favor, digite um título ou parte dele.");
        return;
      }
      // Faz a requisição GET para a rota /buscarreclamacao com o parâmetro 'nome'
        fetch(`http://127.0.0.1:5000/buscarreclamacao?nome=${encodeURIComponent(nome)}`)        .then(response => response.json())
        .then(data => {
          const resultsDiv = document.getElementById('results');
          resultsDiv.innerHTML = ""; // Limpa resultados anteriores
          if (!data.ok) {
            // Caso haja erro no retorno da API
            resultsDiv.textContent = "Erro: " + data.error.message;
            return;
          }
          if (data.data.length === 0) {
            // Sem resultados encontrados
            resultsDiv.textContent = "Nenhuma reclamação encontrada.";
            return;
          }
          // Exibe cada reclamação encontrada
          data.data.forEach(comp => {
            const compDiv = document.createElement('div');
            compDiv.innerHTML = `
              <h3>${comp.titulo}</h3>
              <p>${comp.corpo}</p>
              <p><strong>Categoria:</strong> ${comp.categoria}</p>
              <p><strong>Autor:</strong> ${comp.autor}</p>
              <p><small>${comp.data}</small></p>
            `;
            resultsDiv.appendChild(compDiv);
          });
        })
        .catch(err => console.error("Erro na requisição:", err));
    });
  </script>
</body>
</html>
